<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beylerbeyi SK - Altyapƒ± Y√∂netim Sistemi</title>
    <style>
/* Beylerbeyi SK CSS - Kƒ±sa versiyon */
:root {
  --beylerbeyi-red: #C8102E;
  --beylerbeyi-green: #006B3F;
  --beylerbeyi-dark: #1a1a1a;
  --beylerbeyi-gold: #FFD700;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Segoe UI', sans-serif;
  background: linear-gradient(135deg, var(--beylerbeyi-red), var(--beylerbeyi-dark));
  min-height: 100vh;
  padding: 20px;
}

.container { max-width: 1400px; margin: 0 auto; }

.header {
  background: white;
  padding: 20px 30px;
  border-radius: 12px;
  margin-bottom: 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.header-left { display: flex; align-items: center; gap: 15px; }
.header-logo { width: 50px; height: 50px; object-fit: contain; }
.header h2 { color: var(--beylerbeyi-red); font-size: 24px; }

.user-info { display: flex; align-items: center; gap: 15px; }
.user-badge {
  background: var(--beylerbeyi-red);
  color: white;
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 14px;
  font-weight: 600;
}

.content {
  background: white;
  padding: 30px;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  min-height: 500px;
}

.login-container {
  max-width: 400px;
  margin: 80px auto;
  background: white;
  padding: 40px;
  border-radius: 12px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.2);
}

.login-header { text-align: center; margin-bottom: 30px; }
.login-header img { width: 100px; height: 100px; margin-bottom: 15px; }
.login-header h1 { color: var(--beylerbeyi-red); font-size: 22px; margin-bottom: 5px; }
.login-header .subtitle { color: #666; font-size: 14px; }

.form-group { margin-bottom: 20px; }
.form-group label { display: block; margin-bottom: 8px; color: #333; font-weight: 600; font-size: 14px; }

input, select, textarea {
  width: 100%;
  padding: 12px;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 14px;
  font-family: inherit;
}

input:focus, select:focus { outline: none; border-color: var(--beylerbeyi-red); }

button {
  width: 100%;
  padding: 12px;
  background: var(--beylerbeyi-red);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
}

button:hover { background: #a00d25; }
button:disabled { background: #ccc; cursor: not-allowed; }

.btn-secondary { background: var(--beylerbeyi-green); width: auto; padding: 8px 16px; font-size: 13px; }
.btn-danger { background: #dc3545; }
.action-btn { width: auto; padding: 6px 12px; font-size: 12px; margin: 0 3px; }

.tabs {
  display: flex;
  gap: 10px;
  margin-bottom: 25px;
  border-bottom: 2px solid #e0e0e0;
}

.tab {
  padding: 12px 24px;
  background: none;
  border: none;
  color: #666;
  border-bottom: 3px solid transparent;
  cursor: pointer;
  width: auto;
  font-weight: 600;
}

.tab.active { color: var(--beylerbeyi-red); border-bottom-color: var(--beylerbeyi-red); }
.tab-content { display: none; }
.tab-content.active { display: block; }

.season-selector { margin-bottom: 20px; display: flex; gap: 10px; flex-wrap: wrap; }

.season-btn {
  padding: 10px 20px;
  background: #f5f5f5;
  border: 2px solid #e0e0e0;
  border-radius: 20px;
  cursor: pointer;
  font-weight: 600;
  color: #666;
  width: auto;
}

.season-btn.active { background: var(--beylerbeyi-red); color: white; border-color: var(--beylerbeyi-red); }

.team-filter { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }

.team-badge {
  padding: 10px 20px;
  background: #f5f5f5;
  border: 2px solid #e0e0e0;
  border-radius: 20px;
  cursor: pointer;
  font-weight: 600;
  color: #666;
}

.team-badge.active { background: var(--beylerbeyi-red); color: white; }
.team-badge .count { background: rgba(255,255,255,0.3); padding: 2px 8px; border-radius: 10px; margin-left: 5px; font-size: 12px; }

.players-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.player-card {
  border: 2px solid #e0e0e0;
  border-radius: 12px;
  overflow: hidden;
  cursor: pointer;
  background: white;
}

.player-card:hover { border-color: var(--beylerbeyi-red); box-shadow: 0 8px 16px rgba(200,16,46,0.2); }

.player-card-header {
  background: var(--beylerbeyi-red);
  padding: 12px 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.player-card-header h4 { color: white; font-size: 15px; margin: 0; }

.position-badge {
  background: var(--beylerbeyi-green);
  color: white;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 700;
}

.player-photo {
  width: 100%;
  height: 200px;
  background: #f5f5f5;
  display: flex;
  align-items: center;
  justify-content: center;
}

.player-photo img { width: 100%; height: 100%; object-fit: cover; }

.player-photo-placeholder {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background: var(--beylerbeyi-red);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 32px;
  font-weight: 800;
}

.player-card-body { padding: 15px; }
.player-card .info { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 13px; color: #666; }
.player-card .info strong { color: #333; }

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-bottom: 25px;
}

.stat-card {
  background: var(--beylerbeyi-red);
  color: white;
  padding: 20px;
  border-radius: 12px;
  text-align: center;
}

.stat-card h3 { font-size: 32px; margin-bottom: 5px; }
.stat-card p { font-size: 13px; opacity: 0.9; }
.stat-card.green { background: var(--beylerbeyi-green); }
.stat-card.gold { background: var(--beylerbeyi-gold); color: #333; }
.stat-card.dark { background: var(--beylerbeyi-dark); }

.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.7);
  z-index: 1000;
  overflow-y: auto;
}

.modal-content {
  background: white;
  max-width: 900px;
  margin: 30px auto;
  padding: 30px;
  border-radius: 12px;
  position: relative;
}

.close-modal {
  position: absolute;
  top: 15px;
  right: 20px;
  font-size: 28px;
  color: #999;
  cursor: pointer;
  background: none;
  border: none;
  width: auto;
  padding: 0;
}

.close-modal:hover { color: var(--beylerbeyi-red); }

table { width: 100%; border-collapse: collapse; margin-top: 15px; }
th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e0e0e0; font-size: 14px; }
thead th { background: var(--beylerbeyi-red); color: white; font-weight: 600; }
tbody tr:hover { background: #f8f8f8; }

.eval-section {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 12px;
  border-left: 4px solid var(--beylerbeyi-red);
  margin-bottom: 20px;
}

.eval-section h4 { color: var(--beylerbeyi-dark); margin-bottom: 15px; font-size: 15px; }

.error-message { background: #fff3cd; border: 1px solid #ffc107; color: #856404; padding: 12px; border-radius: 8px; margin-bottom: 15px; display: none; }
.success-message { background: #d4edda; border: 1px solid #28a745; color: #155724; padding: 12px; border-radius: 8px; margin-bottom: 15px; display: none; }

.hidden { display: none !important; }
.text-center { text-align: center; }
.loading { text-align: center; padding: 40px; color: #666; }

.demo-users {
  background: #fff8e1;
  border: 2px solid var(--beylerbeyi-gold);
  padding: 20px;
  border-radius: 12px;
  margin-top: 25px;
}

.demo-users h4 { color: var(--beylerbeyi-dark); margin-bottom: 12px; }
.demo-users p { color: #666; font-size: 14px; margin: 8px 0; }

@media (max-width: 768px) {
  .header { flex-direction: column; }
  .players-grid { grid-template-columns: 1fr; }
  .stats-grid { grid-template-columns: 1fr; }
}

    </style>
</head>
<body>
<div id="loginScreen" class="login-container">
        <div class="login-header">
            <img id="loginLogo" src="" alt="Beylerbeyi SK">
            <h1>Beylerbeyi Spor Kul√ºb√º</h1>
            <p class="subtitle">Altyapƒ± Futbol Akademisi Y√∂netim Sistemi</p>
        </div>
        
        <div id="errorMessage" class="error-message"></div>
        
        <div class="form-group">
            <label for="username">Kullanƒ±cƒ± Adƒ±</label>
            <input type="text" id="username" placeholder="Kullanƒ±cƒ± adƒ±nƒ±zƒ± girin" autocomplete="username">
        </div>
        
        <div class="form-group">
            <label for="password">≈ûifre</label>
            <input type="password" id="password" placeholder="≈ûifrenizi girin" autocomplete="current-password">
        </div>
        
        <button onclick="login()">Giri≈ü Yap</button>

        <div class="demo-users">
            <h4>üìã Demo Hesaplar</h4>
            <p><strong>Admin:</strong> admin / admin123</p>
            <p><strong>U13 Antren√∂r√º:</strong> coach_u13 / coach123</p>
            <p><strong>U15 Antren√∂r√º:</strong> coach_u15 / coach123</p>
            <p><strong>Oyuncu:</strong> player_aziz / player123</p>
            <p><strong>Y√∂netici:</strong> manager / manager123</p>
        </div>
    </div>

    <!-- ==========================================
         DASHBOARD
         ========================================== -->
    <div id="dashboard" class="container" style="display: none;">
        
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <img id="headerLogo" src="" alt="Beylerbeyi SK" class="header-logo">
                <h2 id="dashboardTitle">Dashboard</h2>
            </div>
            <div class="user-info">
                <span class="user-badge" id="userBadge">Kullanƒ±cƒ±</span>
                <button onclick="logout()" class="btn-secondary">√áƒ±kƒ±≈ü Yap</button>
            </div>
        </div>

        <!-- Content -->
        <div class="content">
            
            <!-- Success/Error Messages -->
            <div id="successMessage" class="success-message"></div>
            
            <!-- ==========================================
                 ADMIN VIEW
                 ========================================== -->
            <div id="adminView" style="display: none;">
                <!-- Sezon Se√ßici -->
                <div id="adminSeasonContainer" class="season-selector"></div>
                
                <!-- ƒ∞statistik Kartlarƒ± -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 id="adminTotalPlayers">0</h3>
                        <p>Toplam Oyuncu</p>
                    </div>
                    <div class="stat-card green">
                        <h3 id="adminTotalTeams">0</h3>
                        <p>Takƒ±m Sayƒ±sƒ±</p>
                    </div>
                    <div class="stat-card gold">
                        <h3 id="adminTotalCoaches">0</h3>
                        <p>Antren√∂r Sayƒ±sƒ±</p>
                    </div>
                    <div class="stat-card dark">
                        <h3 id="adminActiveSeasons">0</h3>
                        <p>Aktif Sezon</p>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('adminPlayers')">Oyuncular</button>
                    <button class="tab" onclick="switchTab('adminTeams')">Takƒ±mlar</button>
                    <button class="tab" onclick="switchTab('adminCoaches')">Antren√∂rler</button>
                </div>

                <!-- Oyuncular Tab -->
                <div id="adminPlayersTab" class="tab-content active">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3>T√ºm Oyuncular</h3>
                        <button onclick="showAddPlayerModal()" class="btn-secondary">+ Yeni Oyuncu Ekle</button>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Fotoƒüraf</th>
                                <th>Ad Soyad</th>
                                <th>Ya≈ü Grubu</th>
                                <th>Pozisyon</th>
                                <th>ƒ∞≈ülemler</th>
                            </tr>
                        </thead>
                        <tbody id="adminPlayersList"></tbody>
                    </table>
                </div>

                <!-- Takƒ±mlar Tab -->
                <div id="adminTeamsTab" class="tab-content">
                    <h3>Takƒ±m Y√∂netimi</h3>
                    <p class="info-message">Takƒ±m y√∂netimi mod√ºl√º geli≈ütiriliyor...</p>
                </div>

                <!-- Antren√∂rler Tab -->
                <div id="adminCoachesTab" class="tab-content">
                    <h3>Antren√∂r Y√∂netimi</h3>
                    <p class="info-message">Antren√∂r y√∂netimi mod√ºl√º geli≈ütiriliyor...</p>
                </div>
            </div>

            <!-- ==========================================
                 COACH VIEW (ANTREN√ñR)
                 ========================================== -->
            <div id="coachView" style="display: none;">
                <!-- Sezon Se√ßici -->
                <div id="coachSeasonContainer" class="season-selector"></div>
                
                <!-- ƒ∞statistik Kartlarƒ± -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 id="coachTotalPlayers">0</h3>
                        <p>Oyuncu</p>
                    </div>
                    <div class="stat-card green">
                        <h3 id="coachTotalMatches">0</h3>
                        <p>Toplam Ma√ß</p>
                    </div>
                    <div class="stat-card gold">
                        <h3 id="coachTotalGoals">0</h3>
                        <p>Toplam Gol</p>
                    </div>
                    <div class="stat-card dark">
                        <h3 id="coachTotalAssists">0</h3>
                        <p>Toplam Asist</p>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="tabs">
                    <button class="tab active">Oyuncular</button>
                </div>

                <!-- Oyuncular -->
                <div class="tab-content active">
                    <h3 style="margin-bottom: 20px;">Kayƒ±tlƒ± Oyuncular</h3>
                    
                    <!-- Ya≈ü Grubu Filtresi -->
                    <div id="ageGroupFilter" class="team-filter"></div>
                    
                    <!-- Oyuncu Grid -->
                    <div id="playersGrid" class="players-grid"></div>
                </div>
            </div>

            <!-- ==========================================
                 PLAYER VIEW (OYUNCU)
                 ========================================== -->
            <div id="playerView" style="display: none;">
                <!-- Sezon Se√ßici -->
                <div id="playerSeasonContainer" class="season-selector"></div>
                
                <!-- Oyuncu ƒ∞√ßeriƒüi -->
                <div id="playerContent"></div>
            </div>

            <!-- ==========================================
                 MANAGER VIEW (Y√ñNETƒ∞Cƒ∞)
                 ========================================== -->
            <div id="managerView" style="display: none;">
                <!-- Sezon Se√ßici -->
                <div id="managerSeasonContainer" class="season-selector"></div>
                
                <h3 style="margin-bottom: 25px;">Y√∂netici Raporlarƒ±</h3>
                
                <!-- ƒ∞statistik Kartlarƒ± -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 id="mgrTotalPlayers">0</h3>
                        <p>Toplam Oyuncu</p>
                    </div>
                    <div class="stat-card green">
                        <h3 id="mgrTeamGoals">0</h3>
                        <p>Takƒ±m Gol</p>
                    </div>
                    <div class="stat-card gold">
                        <h3 id="mgrTeamAssists">0</h3>
                        <p>Takƒ±m Asist</p>
                    </div>
                    <div class="stat-card dark">
                        <h3 id="mgrTopScorer">-</h3>
                        <p>En Golc√º</p>
                    </div>
                </div>

                <!-- Raporlar -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 25px; margin-top: 30px;">
                    
                    <!-- Pozisyon Daƒüƒ±lƒ±mƒ± -->
                    <div class="eval-section">
                        <h4>üìä Pozisyon Daƒüƒ±lƒ±mƒ±</h4>
                        <div id="positionDistribution"></div>
                    </div>

                    <!-- En ƒ∞yi Performanslar -->
                    <div class="eval-section">
                        <h4>üèÜ En ƒ∞yi Performans</h4>
                        <div id="topPerformers"></div>
                    </div>

                    <!-- Disiplin Raporu -->
                    <div class="eval-section">
                        <h4>üü® Disiplin Raporu</h4>
                        <div id="disciplineReport"></div>
                    </div>

                    <!-- Ya≈ü Grubu Daƒüƒ±lƒ±mƒ± -->
                    <div class="eval-section">
                        <h4>üë• Ya≈ü Grubu Daƒüƒ±lƒ±mƒ±</h4>
                        <div id="ageGroupDistribution"></div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- ==========================================
         MODALS
         ========================================== -->
    
    <!-- Oyuncu Detay Modal -->
    <div id="playerModal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closePlayerModal()">&times;</button>
            <div id="playerModalContent"></div>
        </div>
    </div>

    <!-- Oyuncu Ekle/D√ºzenle Modal -->
    <div id="addPlayerModal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="closeAddPlayerModal()">&times;</button>
            <h2 id="playerFormTitle">Yeni Oyuncu Ekle</h2>
            <form id="playerForm" onsubmit="savePlayer(event)">
                <input type="hidden" id="playerFormId">
                
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                    <div class="form-group">
                        <label for="playerName">Ad Soyad *</label>
                        <input type="text" id="playerName" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="playerBirthYear">Doƒüum Yƒ±lƒ± *</label>
                        <input type="number" id="playerBirthYear" min="2000" max="2020" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="playerAgeGroup">Ya≈ü Grubu *</label>
                        <select id="playerAgeGroup" required></select>
                    </div>
                    
                    <div class="form-group">
                        <label for="playerPosition">Pozisyon *</label>
                        <select id="playerPosition" required></select>
                    </div>
                    
                    <div class="form-group">
                        <label for="playerHeight">Boy (cm)</label>
                        <input type="number" id="playerHeight" min="100" max="250">
                    </div>
                    
                    <div class="form-group">
                        <label for="playerWeight">Kilo (kg)</label>
                        <input type="number" id="playerWeight" min="30" max="150">
                    </div>
                    
                    <div class="form-group">
                        <label for="playerFoot">Ayak</label>
                        <select id="playerFoot">
                            <option value="Saƒü">Saƒü</option>
                            <option value="Sol">Sol</option>
                            <option value="ƒ∞ki Ayak">ƒ∞ki Ayak</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="playerPreviousClub">√ñnceki Kul√ºp</label>
                        <input type="text" id="playerPreviousClub">
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit">Kaydet</button>
                    <button type="button" class="btn-secondary" onclick="closeAddPlayerModal()">ƒ∞ptal</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ==========================================
         JAVASCRIPT
         ========================================== -->
    
    <!-- Data -->
    
<script>

// ===== DATA.JS =====
// ==========================================
// BEYLERBEYI SK - MERKEZƒ∞ VERƒ∞ YAPISI
// ==========================================

// ==========================================
// SEZONLAR (Free text DEƒûƒ∞L - tanƒ±mlƒ± liste)
// ==========================================
const SEASONS = [
  { id: '2025-2026', name: '2025-2026 Sezonu', active: false, startYear: 2025, endYear: 2026 },
  { id: '2024-2025', name: '2024-2025 Sezonu', active: true, startYear: 2024, endYear: 2025 },
  { id: '2023-2024', name: '2023-2024 Sezonu', active: false, startYear: 2023, endYear: 2024 },
  { id: '2022-2023', name: '2022-2023 Sezonu', active: false, startYear: 2022, endYear: 2023 }
];

// ==========================================
// YA≈û GRUPLARI (Ya≈ü aralƒ±klarƒ± ile)
// ==========================================
const AGE_GROUPS = [
  { id: 'U11', name: 'U11', displayName: 'U11 (10-11 ya≈ü)', minAge: 10, maxAge: 11 },
  { id: 'U13', name: 'U13', displayName: 'U13 (12-13 ya≈ü)', minAge: 12, maxAge: 13 },
  { id: 'U15', name: 'U15', displayName: 'U15 (14-15 ya≈ü)', minAge: 14, maxAge: 15 },
  { id: 'U17', name: 'U17', displayName: 'U17 (16-17 ya≈ü)', minAge: 16, maxAge: 17 },
  { id: 'U19', name: 'U19', displayName: 'U19 (18-19 ya≈ü)', minAge: 18, maxAge: 19 }
];

// ==========================================
// POZƒ∞SYONLAR (Kaleci/Saha oyuncusu ayrƒ±mƒ±)
// ==========================================
const POSITIONS = [
  // Kaleci
  { id: 'GK', name: 'Kaleci', shortName: 'KLC', isGoalkeeper: true, category: 'Defans' },
  
  // Defans
  { id: 'RB', name: 'Saƒü Bek', shortName: 'SB', isGoalkeeper: false, category: 'Defans' },
  { id: 'LB', name: 'Sol Bek', shortName: 'SOB', isGoalkeeper: false, category: 'Defans' },
  { id: 'CB', name: 'Stoper', shortName: 'STP', isGoalkeeper: false, category: 'Defans' },
  { id: 'RWB', name: 'Saƒü Kanat Bek', shortName: 'SKB', isGoalkeeper: false, category: 'Defans' },
  { id: 'LWB', name: 'Sol Kanat Bek', shortName: 'SOKB', isGoalkeeper: false, category: 'Defans' },
  
  // Orta Saha
  { id: 'CDM', name: 'Defansif Orta Saha', shortName: 'DOS', isGoalkeeper: false, category: 'Orta Saha' },
  { id: 'CM', name: 'Orta Saha', shortName: 'OS', isGoalkeeper: false, category: 'Orta Saha' },
  { id: 'CAM', name: 'Ofansif Orta Saha', shortName: 'OOS', isGoalkeeper: false, category: 'Orta Saha' },
  { id: 'RM', name: 'Saƒü Orta Saha', shortName: 'SOS', isGoalkeeper: false, category: 'Orta Saha' },
  { id: 'LM', name: 'Sol Orta Saha', shortName: 'SOOS', isGoalkeeper: false, category: 'Orta Saha' },
  
  // H√ºcum
  { id: 'RW', name: 'Saƒü Kanat', shortName: 'SK', isGoalkeeper: false, category: 'H√ºcum' },
  { id: 'LW', name: 'Sol Kanat', shortName: 'SOK', isGoalkeeper: false, category: 'H√ºcum' },
  { id: 'ST', name: 'Santrafor', shortName: 'ST', isGoalkeeper: false, category: 'H√ºcum' },
  { id: 'CF', name: 'Forvet', shortName: 'FV', isGoalkeeper: false, category: 'H√ºcum' }
];

// ==========================================
// KULLANICILAR (Demo - Yetkilendirme ile)
// ==========================================
const USERS = {
  // Admin - T√ºm yetkilere sahip
  admin: {
    id: 'admin',
    username: 'admin',
    password: 'admin123',
    role: 'admin',
    name: 'Sistem Y√∂neticisi',
    email: 'admin@beylerbeyi.com',
    ageGroups: ['U11', 'U13', 'U15', 'U17', 'U19'], // T√ºm ya≈ü gruplarƒ±
    permissions: {
      viewAllPlayers: true,
      editAllPlayers: true,
      deletePlayer: true,
      manageCoaches: true,
      manageSeasons: true,
      manageTeams: true,
      viewReports: true
    }
  },
  
  // U13 Antren√∂r√º - Sadece U13
  coach_u13: {
    id: 'coach_u13',
    username: 'coach_u13',
    password: 'coach123',
    role: 'coach',
    name: 'Mehmet Yƒ±lmaz',
    email: 'mehmet@beylerbeyi.com',
    ageGroups: ['U13'], // Sadece U13 yetkisi
    permissions: {
      viewAllPlayers: false,
      editAllPlayers: false,
      deletePlayer: false,
      manageCoaches: false,
      manageSeasons: false,
      manageTeams: false,
      viewReports: false
    }
  },
  
  // U15 Antren√∂r√º - Sadece U15
  coach_u15: {
    id: 'coach_u15',
    username: 'coach_u15',
    password: 'coach123',
    role: 'coach',
    name: 'Hasan Demir',
    email: 'hasan@beylerbeyi.com',
    ageGroups: ['U15'], // Sadece U15 yetkisi
    permissions: {
      viewAllPlayers: false,
      editAllPlayers: false,
      deletePlayer: false,
      manageCoaches: false,
      manageSeasons: false,
      manageTeams: false,
      viewReports: false
    }
  },
  
  // Ba≈ü Antren√∂r - Birden fazla ya≈ü grubu
  head_coach: {
    id: 'head_coach',
    username: 'head_coach',
    password: 'coach123',
    role: 'coach',
    name: 'Ali Kaya',
    email: 'ali@beylerbeyi.com',
    ageGroups: ['U15', 'U17'], // U15 ve U17 yetkisi
    permissions: {
      viewAllPlayers: false,
      editAllPlayers: false,
      deletePlayer: false,
      manageCoaches: false,
      manageSeasons: false,
      manageTeams: false,
      viewReports: false
    }
  },
  
  // Oyuncu - Sadece kendi verilerini g√∂r√ºr
  player_aziz: {
    id: 'player_aziz',
    username: 'aziz',
    password: 'player123',
    role: 'player',
    name: 'Aziz Poyraz Duman',
    email: 'aziz@beylerbeyi.com',
    playerId: 1, // players dizisindeki ID
    ageGroups: [],
    permissions: {
      viewAllPlayers: false,
      editAllPlayers: false,
      deletePlayer: false,
      manageCoaches: false,
      manageSeasons: false,
      manageTeams: false,
      viewReports: false
    }
  },
  
  // Y√∂netici - T√ºm raporlarƒ± g√∂rebilir
  manager: {
    id: 'manager',
    username: 'manager',
    password: 'manager123',
    role: 'manager',
    name: 'Ahmet √ñzt√ºrk',
    email: 'ahmet@beylerbeyi.com',
    ageGroups: ['U11', 'U13', 'U15', 'U17', 'U19'], // T√ºm ya≈ü gruplarƒ±
    permissions: {
      viewAllPlayers: true,
      editAllPlayers: false,
      deletePlayer: false,
      manageCoaches: false,
      manageSeasons: false,
      manageTeams: false,
      viewReports: true
    }
  }
};

// ==========================================
// OYUNCULAR (Sezon bazlƒ± istatistikler)
// ==========================================
let players = [
  {
    id: 1,
    name: 'Aziz Poyraz Duman',
    birthYear: 2011,
    ageGroup: 'U15',
    position: 'GK', // Kaleci
    height: 175,
    weight: 65,
    foot: 'Saƒü',
    previousClub: 'Beylerbeyi 1911',
    photo: null, // Base64 veya URL
    joinDate: '2020-09-01',
    active: true,
    
    // Sezon bazlƒ± istatistikler
    seasonStats: {
      '2024-2025': {
        matches: 5,
        minutes: 450,
        goals: 0, // Kaleci i√ßin kullanƒ±lmaz
        assists: 0,
        yellowCards: 0,
        redCards: 0,
        // Kaleciye √∂zel
        cleanSheets: 2,
        goalsConceded: 11,
        saves: 34
      },
      '2023-2024': {
        matches: 8,
        minutes: 720,
        goals: 0,
        assists: 0,
        yellowCards: 1,
        redCards: 0,
        cleanSheets: 3,
        goalsConceded: 15,
        saves: 52
      }
    },
    
    // Fiziksel deƒüerlendirme (1-10)
    physical: {
      sprintSpeed: 6.0,
      endurance: 7.5,
      agility: 8.0,
      balance: 7.5,
      strength: 7.0,
      jumping: 7.5,
      lastUpdated: '2024-12-15'
    },
    
    // Taktik deƒüerlendirme (1-10)
    tactical: {
      gameUnderstanding: 8.0,
      positionKnowledge: 8.5,
      decisionMaking: 7.5,
      transitions: 7.0,
      spacingTiming: 7.5,
      lastUpdated: '2024-12-15'
    },
    
    // Mental deƒüerlendirme (1-10)
    mental: {
      discipline: 8.0,
      workRate: 8.0,
      learningAttitude: 8.5,
      confidence: 7.5,
      competitiveness: 8.0,
      teamHarmony: 9.0,
      pressurePerformance: 7.0,
      lastUpdated: '2024-12-15'
    },
    
    // Saƒülƒ±k bilgileri
    health: {
      pastInjuries: [],
      recurringIssues: 'Yok',
      rehabStatus: 'Aktif',
      loadTolerance: 'ƒ∞yi',
      lastCheckup: '2024-11-20'
    },
    
    // Kariyer ge√ßmi≈üi
    careerHistory: [
      { team: 'Beylerbeyi 1911', years: '2020-2024', role: 'Altyapƒ± Oyuncusu', ageGroup: 'U13' },
      { team: 'Beylerbeyi 1911', years: '2024-Devam', role: 'Altyapƒ± Oyuncusu', ageGroup: 'U15' }
    ],
    
    // Notlar (Antren√∂r yorumlarƒ±)
    notes: [
      {
        date: '2024-12-10',
        author: 'Hasan Demir',
        text: 'Refleksleri √ßok iyi. Ayak oyunu geli≈ütirmeli.',
        season: '2024-2025'
      }
    ]
  },
  
  {
    id: 2,
    name: 'Emre Bozkurt',
    birthYear: 2011,
    ageGroup: 'U15',
    position: 'RB', // Saƒü Bek
    height: 174,
    weight: 65,
    foot: 'Saƒü',
    previousClub: 'Fenerbah√ße',
    photo: null,
    joinDate: '2023-08-15',
    active: true,
    
    seasonStats: {
      '2024-2025': {
        matches: 11,
        minutes: 1016,
        goals: 1,
        assists: 1,
        yellowCards: 2,
        redCards: 0
      },
      '2023-2024': {
        matches: 6,
        minutes: 540,
        goals: 0,
        assists: 2,
        yellowCards: 1,
        redCards: 0
      }
    },
    
    physical: {
      sprintSpeed: 7.5,
      endurance: 8.0,
      agility: 7.0,
      balance: 7.5,
      strength: 7.5,
      jumping: 6.5,
      lastUpdated: '2024-12-15'
    },
    
    tactical: {
      gameUnderstanding: 7.5,
      positionKnowledge: 8.0,
      decisionMaking: 7.0,
      transitions: 8.0,
      spacingTiming: 7.5,
      lastUpdated: '2024-12-15'
    },
    
    mental: {
      discipline: 7.5,
      workRate: 8.5,
      learningAttitude: 8.0,
      confidence: 7.5,
      competitiveness: 8.0,
      teamHarmony: 8.0,
      pressurePerformance: 7.5,
      lastUpdated: '2024-12-15'
    },
    
    health: {
      pastInjuries: ['Ayak burkulmasƒ± - 2023-10'],
      recurringIssues: 'Yok',
      rehabStatus: 'Aktif',
      loadTolerance: 'ƒ∞yi',
      lastCheckup: '2024-11-18'
    },
    
    careerHistory: [
      { team: 'Fenerbah√ße', years: '2018-2023', role: 'Altyapƒ± Oyuncusu', ageGroup: 'U13' },
      { team: 'Beylerbeyi 1911', years: '2023-Devam', role: 'Altyapƒ± Oyuncusu', ageGroup: 'U15' }
    ],
    
    notes: []
  },
  
  {
    id: 3,
    name: 'Mehmet Can Yƒ±lmaz',
    birthYear: 2013,
    ageGroup: 'U13',
    position: 'ST', // Santrafor
    height: 168,
    weight: 58,
    foot: 'Saƒü',
    previousClub: 'Be≈üikta≈ü',
    photo: null,
    joinDate: '2024-01-10',
    active: true,
    
    seasonStats: {
      '2024-2025': {
        matches: 9,
        minutes: 720,
        goals: 12,
        assists: 4,
        yellowCards: 1,
        redCards: 0
      }
    },
    
    physical: {
      sprintSpeed: 8.5,
      endurance: 7.0,
      agility: 8.0,
      balance: 7.5,
      strength: 6.5,
      jumping: 7.0,
      lastUpdated: '2024-12-10'
    },
    
    tactical: {
      gameUnderstanding: 7.0,
      positionKnowledge: 7.5,
      decisionMaking: 7.0,
      transitions: 7.5,
      spacingTiming: 7.0,
      lastUpdated: '2024-12-10'
    },
    
    mental: {
      discipline: 7.0,
      workRate: 8.0,
      learningAttitude: 8.5,
      confidence: 8.0,
      competitiveness: 9.0,
      teamHarmony: 7.5,
      pressurePerformance: 7.5,
      lastUpdated: '2024-12-10'
    },
    
    health: {
      pastInjuries: [],
      recurringIssues: 'Yok',
      rehabStatus: 'Aktif',
      loadTolerance: '√áok ƒ∞yi',
      lastCheckup: '2024-12-05'
    },
    
    careerHistory: [
      { team: 'Be≈üikta≈ü', years: '2021-2023', role: 'Altyapƒ± Oyuncusu', ageGroup: 'U11' },
      { team: 'Beylerbeyi 1911', years: '2024-Devam', role: 'Altyapƒ± Oyuncusu', ageGroup: 'U13' }
    ],
    
    notes: [
      {
        date: '2024-12-08',
        author: 'Mehmet Yƒ±lmaz',
        text: 'Gol pozisyonlarƒ±nƒ± √ßok iyi deƒüerlendiriyor. Fizik olarak geli≈ümeli.',
        season: '2024-2025'
      }
    ]
  }
];

// ==========================================
// TAKIMLAR (Ya≈ü grubu bazlƒ±)
// ==========================================
let teams = [
  {
    id: 1,
    name: 'Beylerbeyi U15',
    ageGroup: 'U15',
    season: '2024-2025',
    league: 'ƒ∞stanbul U15 S√ºper Lig',
    coach: 'Hasan Demir',
    
    // Kadro
    squad: [1, 2], // Player ID'leri
    
    // Puan durumu
    standings: {
      position: 4,
      played: 12,
      won: 8,
      drawn: 2,
      lost: 2,
      goalsFor: 28,
      goalsAgainst: 15,
      goalDifference: 13,
      points: 26
    },
    
    // Ma√ß fikst√ºr√º
    fixtures: [
      {
        id: 1,
        matchday: 1,
        date: '2024-09-15',
        time: '14:00',
        opponent: 'Fenerbah√ße U15',
        homeAway: 'away',
        venue: 'Fenerbah√ße Dereaƒüzƒ± Tesisleri',
        result: {
          played: true,
          goalsFor: 2,
          goalsAgainst: 3,
          scorers: ['Emre Bozkurt'],
          yellowCards: 1,
          redCards: 0
        }
      },
      {
        id: 2,
        matchday: 2,
        date: '2024-09-22',
        time: '15:00',
        opponent: 'Galatasaray U15',
        homeAway: 'home',
        venue: 'Beylerbeyi Sahasƒ±',
        result: {
          played: true,
          goalsFor: 3,
          goalsAgainst: 1,
          scorers: ['Mehmet Can Yƒ±lmaz (2)', 'Emre Bozkurt'],
          yellowCards: 0,
          redCards: 0
        }
      },
      {
        id: 3,
        matchday: 3,
        date: '2024-09-29',
        time: '14:00',
        opponent: 'Be≈üikta≈ü U15',
        homeAway: 'away',
        venue: 'Be≈üikta≈ü Nevzat Demir Tesisleri',
        result: {
          played: false,
          goalsFor: null,
          goalsAgainst: null
        }
      }
    ]
  },
  
  {
    id: 2,
    name: 'Beylerbeyi U13',
    ageGroup: 'U13',
    season: '2024-2025',
    league: 'ƒ∞stanbul U13 1. Lig',
    coach: 'Mehmet Yƒ±lmaz',
    
    squad: [3],
    
    standings: {
      position: 2,
      played: 10,
      won: 7,
      drawn: 2,
      lost: 1,
      goalsFor: 32,
      goalsAgainst: 12,
      goalDifference: 20,
      points: 23
    },
    
    fixtures: []
  }
];

// ==========================================
// LOGO (Base64 veya URL)
// ==========================================
const BEYLERBEYI_LOGO = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSI0NSIgZmlsbD0iI0M4MTAyRSIvPjxwYXRoIGQ9Ik0zNSw0NSBMNjUsNDUgTDUwLDcwIFoiIGZpbGw9IndoaXRlIi8+PHRleHQgeD0iNTAiIHk9IjM1IiBmb250LXNpemU9IjE2IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC13ZWlnaHQ9ImJvbGQiPkJTSzwvdGV4dD48L3N2Zz4=';

// ==========================================
// DEFAULT AVATAR
// ==========================================
const DEFAULT_AVATAR = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjEwMCIgZmlsbD0iI2U1ZTVlNSIvPjxjaXJjbGUgY3g9IjEwMCIgY3k9Ijc1IiByPSIzNSIgZmlsbD0iIzk5OSIvPjxlbGxpcHNlIGN4PSIxMDAiIGN5PSIxNzAiIHJ4PSI1NSIgcnk9IjQwIiBmaWxsPSIjOTk5Ii8+PC9zdmc+';


// ===== HELPERS.JS =====
// ==========================================
// HELPER FUNCTIONS
// ==========================================

// ==========================================
// SEZON ƒ∞≈ûLEMLERƒ∞
// ==========================================

/**
 * Aktif sezonu d√∂nd√ºr
 */
function getActiveSeason() {
  const activeSeason = SEASONS.find(s => s.active);
  return activeSeason || SEASONS[0];
}

/**
 * Sezon ID'sine g√∂re sezon bilgisi al
 */
function getSeasonById(seasonId) {
  return SEASONS.find(s => s.id === seasonId);
}

// ==========================================
// YA≈û GRUBU ƒ∞≈ûLEMLERƒ∞
// ==========================================

/**
 * Doƒüum yƒ±lƒ±ndan ya≈ü hesapla
 */
function calculateAge(birthYear) {
  const currentYear = new Date().getFullYear();
  return currentYear - birthYear;
}

/**
 * Doƒüum yƒ±lƒ±ndan ya≈ü grubu belirle
 */
function getAgeGroupFromBirthYear(birthYear) {
  const age = calculateAge(birthYear);
  const ageGroup = AGE_GROUPS.find(ag => age >= ag.minAge && age <= ag.maxAge);
  return ageGroup ? ageGroup.id : null;
}

/**
 * Ya≈ü grubu ID'sine g√∂re bilgi al
 */
function getAgeGroupById(ageGroupId) {
  return AGE_GROUPS.find(ag => ag.id === ageGroupId);
}

// ==========================================
// POZƒ∞SYON ƒ∞≈ûLEMLERƒ∞
// ==========================================

/**
 * Pozisyon kaleci mi kontrol et
 */
function isGoalkeeper(positionId) {
  const position = POSITIONS.find(p => p.id === positionId);
  return position ? position.isGoalkeeper : false;
}

/**
 * Pozisyon ID'sine g√∂re bilgi al
 */
function getPositionById(positionId) {
  return POSITIONS.find(p => p.id === positionId);
}

/**
 * Pozisyon adƒ±nƒ± al
 */
function getPositionName(positionId) {
  const position = getPositionById(positionId);
  return position ? position.name : 'Bilinmiyor';
}

// ==========================================
// OYUNCU ƒ∞≈ûLEMLERƒ∞
// ==========================================

/**
 * ID'ye g√∂re oyuncu bul
 */
function getPlayerById(playerId) {
  return players.find(p => p.id === playerId);
}

/**
 * Ya≈ü grubuna g√∂re oyuncularƒ± filtrele
 */
function getPlayersByAgeGroup(ageGroup) {
  if (ageGroup === 'all') return players;
  return players.filter(p => p.ageGroup === ageGroup);
}

/**
 * Kullanƒ±cƒ±nƒ±n g√∂rebileceƒüi oyuncularƒ± getir (yetkilendirme)
 */
function getAuthorizedPlayers(user) {
  if (!user) return [];
  
  // Admin ve Manager t√ºm oyuncularƒ± g√∂rebilir
  if (user.role === 'admin' || user.role === 'manager') {
    return players;
  }
  
  // Antren√∂r sadece kendi ya≈ü gruplarƒ±ndaki oyuncularƒ± g√∂rebilir
  if (user.role === 'coach') {
    return players.filter(p => user.ageGroups.includes(p.ageGroup));
  }
  
  // Oyuncu sadece kendini g√∂rebilir
  if (user.role === 'player' && user.playerId) {
    const player = getPlayerById(user.playerId);
    return player ? [player] : [];
  }
  
  return [];
}

/**
 * Yeni oyuncu i√ßin ID olu≈ütur
 */
function getNextPlayerId() {
  if (players.length === 0) return 1;
  return Math.max(...players.map(p => p.id)) + 1;
}

/**
 * Oyuncu ekle
 */
function addPlayer(playerData) {
  const newPlayer = {
    id: getNextPlayerId(),
    ...playerData,
    active: true,
    seasonStats: {},
    physical: {
      sprintSpeed: 5.0,
      endurance: 5.0,
      agility: 5.0,
      balance: 5.0,
      strength: 5.0,
      jumping: 5.0,
      lastUpdated: new Date().toISOString().split('T')[0]
    },
    tactical: {
      gameUnderstanding: 5.0,
      positionKnowledge: 5.0,
      decisionMaking: 5.0,
      transitions: 5.0,
      spacingTiming: 5.0,
      lastUpdated: new Date().toISOString().split('T')[0]
    },
    mental: {
      discipline: 5.0,
      workRate: 5.0,
      learningAttitude: 5.0,
      confidence: 5.0,
      competitiveness: 5.0,
      teamHarmony: 5.0,
      pressurePerformance: 5.0,
      lastUpdated: new Date().toISOString().split('T')[0]
    },
    health: {
      pastInjuries: [],
      recurringIssues: 'Yok',
      rehabStatus: 'Aktif',
      loadTolerance: 'ƒ∞yi',
      lastCheckup: new Date().toISOString().split('T')[0]
    },
    careerHistory: [],
    notes: []
  };
  
  players.push(newPlayer);
  return newPlayer;
}

/**
 * Oyuncu g√ºncelle
 */
function updatePlayer(playerId, updates) {
  const playerIndex = players.findIndex(p => p.id === playerId);
  if (playerIndex === -1) return null;
  
  players[playerIndex] = {
    ...players[playerIndex],
    ...updates
  };
  
  return players[playerIndex];
}

/**
 * Oyuncu sil
 */
function deletePlayer(playerId) {
  const playerIndex = players.findIndex(p => p.id === playerId);
  if (playerIndex === -1) return false;
  
  players.splice(playerIndex, 1);
  return true;
}

/**
 * Oyuncuya sezon istatistiƒüi ekle/g√ºncelle
 */
function updatePlayerSeasonStats(playerId, seasonId, stats) {
  const player = getPlayerById(playerId);
  if (!player) return null;
  
  if (!player.seasonStats) {
    player.seasonStats = {};
  }
  
  player.seasonStats[seasonId] = {
    ...player.seasonStats[seasonId],
    ...stats
  };
  
  return player;
}

/**
 * Oyuncunun belirli sezondaki istatistiklerini al
 */
function getPlayerSeasonStats(playerId, seasonId) {
  const player = getPlayerById(playerId);
  if (!player || !player.seasonStats) return null;
  
  return player.seasonStats[seasonId] || {
    matches: 0,
    minutes: 0,
    goals: 0,
    assists: 0,
    yellowCards: 0,
    redCards: 0
  };
}

// ==========================================
// TAKIM ƒ∞≈ûLEMLERƒ∞
// ==========================================

/**
 * ID'ye g√∂re takƒ±m bul
 */
function getTeamById(teamId) {
  return teams.find(t => t.id === teamId);
}

/**
 * Ya≈ü grubuna g√∂re takƒ±mlarƒ± filtrele
 */
function getTeamsByAgeGroup(ageGroup, seasonId = null) {
  let filtered = teams.filter(t => t.ageGroup === ageGroup);
  
  if (seasonId) {
    filtered = filtered.filter(t => t.season === seasonId);
  }
  
  return filtered;
}

/**
 * Kullanƒ±cƒ±nƒ±n g√∂rebileceƒüi takƒ±mlarƒ± getir
 */
function getAuthorizedTeams(user, seasonId = null) {
  if (!user) return [];
  
  if (user.role === 'admin' || user.role === 'manager') {
    return seasonId ? teams.filter(t => t.season === seasonId) : teams;
  }
  
  if (user.role === 'coach') {
    let filtered = teams.filter(t => user.ageGroups.includes(t.ageGroup));
    if (seasonId) {
      filtered = filtered.filter(t => t.season === seasonId);
    }
    return filtered;
  }
  
  return [];
}

// ==========================================
// YETKƒ∞LENDƒ∞RME ƒ∞≈ûLEMLERƒ∞
// ==========================================

/**
 * Kullanƒ±cƒ±nƒ±n belirli bir oyuncuyu d√ºzenleme yetkisi var mƒ±?
 */
function canEditPlayer(user, playerId) {
  if (!user) return false;
  
  // Admin her ≈üeyi d√ºzenleyebilir
  if (user.role === 'admin') return true;
  
  const player = getPlayerById(playerId);
  if (!player) return false;
  
  // Antren√∂r sadece kendi ya≈ü grubundaki oyuncularƒ± d√ºzenleyebilir
  if (user.role === 'coach') {
    return user.ageGroups.includes(player.ageGroup);
  }
  
  return false;
}

/**
 * Kullanƒ±cƒ±nƒ±n oyuncu silme yetkisi var mƒ±?
 */
function canDeletePlayer(user, playerId) {
  if (!user) return false;
  
  // Sadece admin silebilir
  return user.role === 'admin';
}

/**
 * Kullanƒ±cƒ±nƒ±n raporlarƒ± g√∂r√ºnt√ºleme yetkisi var mƒ±?
 */
function canViewReports(user) {
  if (!user) return false;
  return user.permissions && user.permissions.viewReports;
}

// ==========================================
// ARAMA VE Fƒ∞LTRELEME
// ==========================================

/**
 * Oyuncularƒ± isme g√∂re ara
 */
function searchPlayersByName(searchTerm) {
  if (!searchTerm) return players;
  
  const term = searchTerm.toLowerCase().trim();
  return players.filter(p => 
    p.name.toLowerCase().includes(term)
  );
}

/**
 * √áoklu filtre ile oyuncu ara
 */
function filterPlayers(filters) {
  let filtered = [...players];
  
  // Ya≈ü grubu filtresi
  if (filters.ageGroup && filters.ageGroup !== 'all') {
    filtered = filtered.filter(p => p.ageGroup === filters.ageGroup);
  }
  
  // Pozisyon filtresi
  if (filters.position && filters.position !== 'all') {
    filtered = filtered.filter(p => p.position === filters.position);
  }
  
  // ƒ∞sim aramasƒ±
  if (filters.searchTerm) {
    const term = filters.searchTerm.toLowerCase().trim();
    filtered = filtered.filter(p => p.name.toLowerCase().includes(term));
  }
  
  // Aktif/Pasif filtresi
  if (filters.active !== undefined) {
    filtered = filtered.filter(p => p.active === filters.active);
  }
  
  return filtered;
}

// ==========================================
// ƒ∞STATƒ∞STƒ∞K HESAPLAMALARI
// ==========================================

/**
 * Belirli sezon i√ßin takƒ±m geneli istatistikler
 */
function getTeamStats(ageGroup, seasonId) {
  const teamPlayers = getPlayersByAgeGroup(ageGroup);
  
  const stats = {
    totalPlayers: teamPlayers.length,
    totalMatches: 0,
    totalMinutes: 0,
    totalGoals: 0,
    totalAssists: 0,
    totalYellowCards: 0,
    totalRedCards: 0,
    averageAge: 0
  };
  
  teamPlayers.forEach(player => {
    const seasonStats = getPlayerSeasonStats(player.id, seasonId);
    if (seasonStats) {
      stats.totalMatches += seasonStats.matches || 0;
      stats.totalMinutes += seasonStats.minutes || 0;
      stats.totalGoals += seasonStats.goals || 0;
      stats.totalAssists += seasonStats.assists || 0;
      stats.totalYellowCards += seasonStats.yellowCards || 0;
      stats.totalRedCards += seasonStats.redCards || 0;
    }
  });
  
  // Ortalama ya≈ü
  if (teamPlayers.length > 0) {
    const totalAge = teamPlayers.reduce((sum, p) => sum + calculateAge(p.birthYear), 0);
    stats.averageAge = (totalAge / teamPlayers.length).toFixed(1);
  }
  
  return stats;
}

/**
 * En iyi performans g√∂steren oyuncularƒ± bul
 */
function getTopPerformers(seasonId, limit = 5) {
  const playersWithStats = players.map(player => {
    const stats = getPlayerSeasonStats(player.id, seasonId);
    return {
      player,
      stats,
      totalContribution: (stats.goals || 0) + (stats.assists || 0)
    };
  }).filter(p => p.stats.matches > 0);
  
  return playersWithStats
    .sort((a, b) => b.totalContribution - a.totalContribution)
    .slice(0, limit);
}

// ==========================================
// FORMAT VE G√ñSTERIM
// ==========================================

/**
 * Dakikayƒ± saat:dakika formatƒ±na √ßevir
 */
function formatMinutes(minutes) {
  if (!minutes) return '0:00';
  const hours = Math.floor(minutes / 60);
  const mins = minutes % 60;
  return `${hours}:${mins.toString().padStart(2, '0')}`;
}

/**
 * Tarihi formatla
 */
function formatDate(dateString) {
  if (!dateString) return '';
  const date = new Date(dateString);
  return date.toLocaleDateString('tr-TR', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  });
}

/**
 * Skor formatla (3-1 gibi)
 */
function formatScore(goalsFor, goalsAgainst) {
  return `${goalsFor}-${goalsAgainst}`;
}

// ==========================================
// DOƒûRULAMA (VALIDATION)
// ==========================================

/**
 * Email doƒürula
 */
function validateEmail(email) {
  const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return re.test(email);
}

/**
 * Oyuncu verisi doƒürula
 */
function validatePlayerData(data) {
  const errors = [];
  
  if (!data.name || data.name.trim().length < 3) {
    errors.push('ƒ∞sim en az 3 karakter olmalƒ±dƒ±r');
  }
  
  if (!data.birthYear || data.birthYear < 2000 || data.birthYear > new Date().getFullYear()) {
    errors.push('Ge√ßerli bir doƒüum yƒ±lƒ± giriniz');
  }
  
  if (!data.ageGroup || !AGE_GROUPS.find(ag => ag.id === data.ageGroup)) {
    errors.push('Ge√ßerli bir ya≈ü grubu se√ßiniz');
  }
  
  if (!data.position || !POSITIONS.find(p => p.id === data.position)) {
    errors.push('Ge√ßerli bir pozisyon se√ßiniz');
  }
  
  if (data.height && (data.height < 100 || data.height > 250)) {
    errors.push('Boy 100-250 cm arasƒ±nda olmalƒ±dƒ±r');
  }
  
  if (data.weight && (data.weight < 30 || data.weight > 150)) {
    errors.push('Kilo 30-150 kg arasƒ±nda olmalƒ±dƒ±r');
  }
  
  return {
    isValid: errors.length === 0,
    errors
  };
}

/**
 * ƒ∞statistik verisi doƒürula
 */
function validateStats(stats) {
  const errors = [];
  
  if (stats.matches < 0) errors.push('Ma√ß sayƒ±sƒ± negatif olamaz');
  if (stats.minutes < 0) errors.push('Dakika negatif olamaz');
  if (stats.goals < 0) errors.push('Gol sayƒ±sƒ± negatif olamaz');
  if (stats.assists < 0) errors.push('Asist sayƒ±sƒ± negatif olamaz');
  if (stats.yellowCards < 0) errors.push('Sarƒ± kart sayƒ±sƒ± negatif olamaz');
  if (stats.redCards < 0) errors.push('Kƒ±rmƒ±zƒ± kart sayƒ±sƒ± negatif olamaz');
  
  return {
    isValid: errors.length === 0,
    errors
  };
}

// ==========================================
// LOCAL STORAGE ƒ∞≈ûLEMLERƒ∞
// ==========================================

/**
 * Verileri localStorage'a kaydet
 */
function saveToLocalStorage() {
  try {
    localStorage.setItem('beylerbeyi_players', JSON.stringify(players));
    localStorage.setItem('beylerbeyi_teams', JSON.stringify(teams));
    localStorage.setItem('beylerbeyi_seasons', JSON.stringify(SEASONS));
    return true;
  } catch (error) {
    console.error('LocalStorage kayƒ±t hatasƒ±:', error);
    return false;
  }
}

/**
 * localStorage'dan verileri y√ºkle
 */
function loadFromLocalStorage() {
  try {
    const savedPlayers = localStorage.getItem('beylerbeyi_players');
    const savedTeams = localStorage.getItem('beylerbeyi_teams');
    const savedSeasons = localStorage.getItem('beylerbeyi_seasons');
    
    if (savedPlayers) players = JSON.parse(savedPlayers);
    if (savedTeams) teams = JSON.parse(savedTeams);
    // SEASONS constant olduƒüu i√ßin y√ºklenmiyor
    
    return true;
  } catch (error) {
    console.error('LocalStorage y√ºkleme hatasƒ±:', error);
    return false;
  }
}

/**
 * localStorage'ƒ± temizle
 */
function clearLocalStorage() {
  try {
    localStorage.removeItem('beylerbeyi_players');
    localStorage.removeItem('beylerbeyi_teams');
    localStorage.removeItem('beylerbeyi_seasons');
    return true;
  } catch (error) {
    console.error('LocalStorage temizleme hatasƒ±:', error);
    return false;
  }
}

// ==========================================
// GENEL YARDIMCI FONKSƒ∞YONLAR
// ==========================================

/**
 * Rastgele ID olu≈ütur
 */
function generateId() {
  return Date.now().toString(36) + Math.random().toString(36).substr(2);
}

/**
 * Dizi i√ßinde benzersiz deƒüerleri bul
 */
function getUniqueValues(array, key) {
  return [...new Set(array.map(item => item[key]))];
}

/**
 * Nesneyi derin kopyala
 */
function deepClone(obj) {
  return JSON.parse(JSON.stringify(obj));
}

/**
 * Console'a renkli log bas (debug i√ßin)
 */
function debugLog(message, type = 'info') {
  const colors = {
    info: 'color: #2196F3',
    success: 'color: #4CAF50',
    warning: 'color: #FF9800',
    error: 'color: #F44336'
  };
  
  console.log(`%c${message}`, colors[type] || colors.info);
}


// ===== APP.JS =====
// ==========================================
// BEYLERBEYI SK - ANA UYGULAMA
// ==========================================

// Global State
let currentUser = null;
let currentSeason = getActiveSeason().id;
let currentAgeGroupFilter = 'all';

// ==========================================
// SAYFA Y√úKLENDƒ∞ƒûƒ∞NDE
// ==========================================

document.addEventListener('DOMContentLoaded', function() {
  console.log('üèÜ Beylerbeyi SK Sistemi Ba≈ülatƒ±lƒ±yor...');
  
  // LocalStorage'dan verileri y√ºkle
  loadFromLocalStorage();
  
  // Session kontrol√º
  checkSession();
  
  // Logo'larƒ± y√ºkle
  loadLogos();
  
  console.log('‚úÖ Sistem hazƒ±r');
});

// ==========================================
// SESSION Y√ñNETƒ∞Mƒ∞
// ==========================================

/**
 * Session kontrol√º - kullanƒ±cƒ± giri≈ü yapmƒ±≈ü mƒ±?
 */
function checkSession() {
  const savedSession = sessionStorage.getItem('beylerbeyi_session');
  
  if (savedSession) {
    try {
      const session = JSON.parse(savedSession);
      currentUser = session.user;
      currentSeason = session.season || getActiveSeason().id;
      
      // Dashboard'a y√∂nlendir
      showDashboard();
    } catch (error) {
      console.error('Session hatasƒ±:', error);
      showLogin();
    }
  } else {
    showLogin();
  }
}

/**
 * Session kaydet
 */
function saveSession() {
  const session = {
    user: currentUser,
    season: currentSeason,
    timestamp: new Date().toISOString()
  };
  
  sessionStorage.setItem('beylerbeyi_session', JSON.stringify(session));
}

/**
 * Session sil (√ßƒ±kƒ±≈ü yap)
 */
function clearSession() {
  sessionStorage.removeItem('beylerbeyi_session');
  currentUser = null;
  currentSeason = getActiveSeason().id;
}

// ==========================================
// Gƒ∞Rƒ∞≈û EKRANI
// ==========================================

/**
 * Login ekranƒ±nƒ± g√∂ster
 */
function showLogin() {
  document.getElementById('loginScreen').style.display = 'block';
  document.getElementById('dashboard').style.display = 'none';
}

/**
 * Giri≈ü yap
 */
function login() {
  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value;
  
  if (!username || !password) {
    showError('Kullanƒ±cƒ± adƒ± ve ≈üifre gereklidir');
    return;
  }
  
  // Kullanƒ±cƒ±yƒ± bul
  const user = USERS[username];
  
  if (!user) {
    showError('Kullanƒ±cƒ± bulunamadƒ±');
    return;
  }
  
  if (user.password !== password) {
    showError('≈ûifre hatalƒ±');
    return;
  }
  
  // Giri≈ü ba≈üarƒ±lƒ±
  currentUser = user;
  saveSession();
  
  console.log('‚úÖ Giri≈ü ba≈üarƒ±lƒ±:', currentUser.name);
  
  showDashboard();
}

/**
 * √áƒ±kƒ±≈ü yap
 */
function logout() {
  if (confirm('√áƒ±kƒ±≈ü yapmak istediƒüinize emin misiniz?')) {
    clearSession();
    showLogin();
    
    // Formu temizle
    document.getElementById('username').value = '';
    document.getElementById('password').value = '';
    
    console.log('üëã √áƒ±kƒ±≈ü yapƒ±ldƒ±');
  }
}

// ==========================================
// DASHBOARD
// ==========================================

/**
 * Dashboard'u g√∂ster (role g√∂re)
 */
function showDashboard() {
  document.getElementById('loginScreen').style.display = 'none';
  document.getElementById('dashboard').style.display = 'block';
  
  // Kullanƒ±cƒ± bilgisini g√∂ster
  document.getElementById('userBadge').textContent = currentUser.name;
  
  // Role g√∂re dashboard ba≈ülƒ±ƒüƒ±nƒ± ayarla
  const roleNames = {
    admin: 'Admin Paneli',
    coach: 'Antren√∂r Paneli',
    player: 'Oyuncu Paneli',
    manager: 'Y√∂netici Paneli'
  };
  
  document.getElementById('dashboardTitle').textContent = roleNames[currentUser.role] || 'Panel';
  
  // T√ºm view'larƒ± gizle
  document.getElementById('adminView').style.display = 'none';
  document.getElementById('coachView').style.display = 'none';
  document.getElementById('playerView').style.display = 'none';
  document.getElementById('managerView').style.display = 'none';
  
  // Role g√∂re ilgili view'ƒ± g√∂ster
  switch (currentUser.role) {
    case 'admin':
      document.getElementById('adminView').style.display = 'block';
      loadAdminView();
      break;
    case 'coach':
      document.getElementById('coachView').style.display = 'block';
      loadCoachView();
      break;
    case 'player':
      document.getElementById('playerView').style.display = 'block';
      loadPlayerView();
      break;
    case 'manager':
      document.getElementById('managerView').style.display = 'block';
      loadManagerView();
      break;
  }
}

// ==========================================
// SEZON SE√áƒ∞Cƒ∞
// ==========================================

/**
 * Sezon butonlarƒ±nƒ± render et
 */
function renderSeasonButtons(containerId) {
  const container = document.getElementById(containerId);
  if (!container) return;
  
  let html = '';
  for (let i = 0; i < SEASONS.length; i++) {
    const season = SEASONS[i];
    const isActive = season.id === currentSeason;
    html += '<button class="season-btn' + (isActive ? ' active' : '') + '" onclick="changeSeason(\'' + season.id + '\')">' + season.name + '</button>';
  }
  
  container.innerHTML = html;
}

/**
 * Sezon deƒüi≈ütir
 */
function changeSeason(seasonId) {
  currentSeason = seasonId;
  saveSession();
  
  // Sezon butonlarƒ±nƒ± g√ºncelle
  renderSeasonButtons('coachSeasonContainer');
  renderSeasonButtons('playerSeasonContainer');
  renderSeasonButtons('managerSeasonContainer');
  renderSeasonButtons('adminSeasonContainer');
  
  // ƒ∞lgili view'ƒ± yeniden y√ºkle
  switch (currentUser.role) {
    case 'admin':
      loadAdminView();
      break;
    case 'coach':
      loadCoachView();
      break;
    case 'player':
      loadPlayerView();
      break;
    case 'manager':
      loadManagerView();
      break;
  }
  
  console.log('üóìÔ∏è Sezon deƒüi≈ütirildi:', seasonId);
}

// ==========================================
// YA≈û GRUBU Fƒ∞LTRESƒ∞
// ==========================================

/**
 * Ya≈ü grubu filtre butonlarƒ±nƒ± render et
 */
function renderAgeGroupFilter(containerId, showAll = true) {
  const container = document.getElementById(containerId);
  if (!container) return;
  
  let html = '';
  
  // "T√ºm√º" butonu
  if (showAll) {
    const isActive = currentAgeGroupFilter === 'all';
    const count = players.length;
    html += '<div class="team-badge' + (isActive ? ' active' : '') + '" onclick="changeAgeGroupFilter(\'all\')">';
    html += 'T√ºm√º <span class="count">' + count + '</span>';
    html += '</div>';
  }
  
  // Ya≈ü grubu butonlarƒ± (kullanƒ±cƒ±nƒ±n yetkili olduƒüu)
  const authorizedAgeGroups = currentUser.role === 'admin' || currentUser.role === 'manager'
    ? AGE_GROUPS
    : AGE_GROUPS.filter(ag => currentUser.ageGroups.includes(ag.id));
  
  for (let i = 0; i < authorizedAgeGroups.length; i++) {
    const ageGroup = authorizedAgeGroups[i];
    const isActive = currentAgeGroupFilter === ageGroup.id;
    const count = getPlayersByAgeGroup(ageGroup.id).length;
    
    html += '<div class="team-badge' + (isActive ? ' active' : '') + '" onclick="changeAgeGroupFilter(\'' + ageGroup.id + '\')">';
    html += ageGroup.name + ' <span class="count">' + count + '</span>';
    html += '</div>';
  }
  
  container.innerHTML = html;
}

/**
 * Ya≈ü grubu filtresini deƒüi≈ütir
 */
function changeAgeGroupFilter(ageGroup) {
  currentAgeGroupFilter = ageGroup;
  
  // Filtreyi yeniden render et
  renderAgeGroupFilter('ageGroupFilter');
  
  // Oyuncu gridini yeniden render et
  renderPlayersGrid();
  
  console.log('üéØ Ya≈ü grubu filtresi:', ageGroup);
}

// ==========================================
// OYUNCU GRƒ∞Dƒ∞
// ==========================================

/**
 * Oyuncu kartlarƒ±nƒ± render et
 */
function renderPlayersGrid() {
  const container = document.getElementById('playersGrid');
  if (!container) return;
  
  // Yetkilendirilmi≈ü oyuncularƒ± al
  let playersToShow = getAuthorizedPlayers(currentUser);
  
  // Ya≈ü grubu filtresini uygula
  if (currentAgeGroupFilter !== 'all') {
    playersToShow = playersToShow.filter(p => p.ageGroup === currentAgeGroupFilter);
  }
  
  // Grid'i olu≈ütur
  let html = '';
  
  for (let i = 0; i < playersToShow.length; i++) {
    const player = playersToShow[i];
    const stats = getPlayerSeasonStats(player.id, currentSeason);
    const positionName = getPositionName(player.position);
    const isGK = isGoalkeeper(player.position);
    
    html += '<div class="player-card" onclick="openPlayerModal(' + player.id + ')">';
    
    // Header
    html += '<div class="player-card-header">';
    html += '<h4>' + player.name + '</h4>';
    html += '<span class="position-badge">' + positionName + '</span>';
    html += '</div>';
    
    // Fotoƒüraf
    html += '<div class="player-photo">';
    if (player.photo) {
      html += '<img src="' + player.photo + '" alt="' + player.name + '">';
    } else {
      // Default avatar - ƒ∞smin ba≈ü harfleri
      const initials = player.name.split(' ').map(n => n[0]).join('');
      html += '<div class="player-photo-placeholder">' + initials + '</div>';
    }
    html += '</div>';
    
    // Body - ƒ∞statistikler
    html += '<div class="player-card-body">';
    html += '<div class="info"><strong>Ya≈ü Grubu:</strong> <span>' + player.ageGroup + '</span></div>';
    html += '<div class="info"><strong>Ma√ß:</strong> <span>' + stats.matches + '</span></div>';
    html += '<div class="info"><strong>Dakika:</strong> <span>' + stats.minutes + '</span></div>';
    
    if (isGK) {
      // Kaleci istatistikleri
      html += '<div class="info"><strong>Kale Koruma:</strong> <span>' + (stats.cleanSheets || 0) + '</span></div>';
      html += '<div class="info"><strong>Yediƒüi Gol:</strong> <span>' + (stats.goalsConceded || 0) + '</span></div>';
    } else {
      // Saha oyuncusu istatistikleri
      html += '<div class="info"><strong>Gol:</strong> <span>' + stats.goals + '</span></div>';
      html += '<div class="info"><strong>Asist:</strong> <span>' + stats.assists + '</span></div>';
    }
    
    html += '<div class="info"><strong>Kartlar:</strong> <span>üü® ' + stats.yellowCards + ' üü• ' + stats.redCards + '</span></div>';
    html += '</div>';
    
    html += '</div>';
  }
  
  if (playersToShow.length === 0) {
    html = '<div class="text-center" style="padding: 40px; color: #666;">Oyuncu bulunamadƒ±</div>';
  }
  
  container.innerHTML = html;
}

// ==========================================
// HATA VE BA≈ûARI MESAJLARI
// ==========================================

/**
 * Hata mesajƒ± g√∂ster
 */
function showError(message) {
  const errorDiv = document.getElementById('errorMessage');
  if (errorDiv) {
    errorDiv.textContent = message;
    errorDiv.style.display = 'block';
    
    setTimeout(() => {
      errorDiv.style.display = 'none';
    }, 5000);
  } else {
    alert('Hata: ' + message);
  }
}

/**
 * Ba≈üarƒ± mesajƒ± g√∂ster
 */
function showSuccess(message) {
  const successDiv = document.getElementById('successMessage');
  if (successDiv) {
    successDiv.textContent = message;
    successDiv.style.display = 'block';
    
    setTimeout(() => {
      successDiv.style.display = 'none';
    }, 3000);
  } else {
    alert(message);
  }
}

// ==========================================
// LOGO Y√úKLEME
// ==========================================

/**
 * Logo'larƒ± y√ºkle
 */
function loadLogos() {
  const loginLogo = document.getElementById('loginLogo');
  const headerLogo = document.getElementById('headerLogo');
  
  if (loginLogo) loginLogo.src = BEYLERBEYI_LOGO;
  if (headerLogo) headerLogo.src = BEYLERBEYI_LOGO;
}

// ==========================================
// TAB Y√ñNETƒ∞Mƒ∞
// ==========================================

/**
 * Tab deƒüi≈ütir
 */
function switchTab(tabName) {
  // T√ºm tab i√ßeriklerini gizle
  const tabContents = document.querySelectorAll('.tab-content');
  for (let i = 0; i < tabContents.length; i++) {
    tabContents[i].classList.remove('active');
  }
  
  // T√ºm tab butonlarƒ±nƒ± pasif yap
  const tabs = document.querySelectorAll('.tab');
  for (let i = 0; i < tabs.length; i++) {
    tabs[i].classList.remove('active');
  }
  
  // Se√ßili tab'ƒ± aktif yap
  const selectedTab = document.getElementById(tabName + 'Tab');
  if (selectedTab) {
    selectedTab.classList.add('active');
  }
  
  // ƒ∞lgili butonu aktif yap
  if (event && event.target) {
    event.target.classList.add('active');
  }
}


// ===== VIEWS.JS =====
// ==========================================
// ROLE-SPECIFIC VIEWS
// ==========================================

// ==========================================
// ANTREN√ñR VIEW
// ==========================================

/**
 * Antren√∂r panelini y√ºkle
 */
function loadCoachView() {
  console.log('üìã Antren√∂r paneli y√ºkleniyor...');
  
  // Sezon butonlarƒ±nƒ± render et
  renderSeasonButtons('coachSeasonContainer');
  
  // Ya≈ü grubu filtresini render et
  renderAgeGroupFilter('ageGroupFilter', true);
  
  // Oyuncu gridini render et
  renderPlayersGrid();
  
  // ƒ∞statistik kartlarƒ±nƒ± g√∂ster
  showCoachStats();
}

/**
 * Antren√∂r istatistiklerini g√∂ster
 */
function showCoachStats() {
  const authorizedPlayers = getAuthorizedPlayers(currentUser);
  const stats = {
    totalPlayers: authorizedPlayers.length,
    totalMatches: 0,
    totalGoals: 0,
    totalAssists: 0
  };
  
  authorizedPlayers.forEach(player => {
    const seasonStats = getPlayerSeasonStats(player.id, currentSeason);
    if (seasonStats) {
      stats.totalMatches += seasonStats.matches || 0;
      stats.totalGoals += seasonStats.goals || 0;
      stats.totalAssists += seasonStats.assists || 0;
    }
  });
  
  // Kartlarƒ± g√ºncelle
  document.getElementById('coachTotalPlayers').textContent = stats.totalPlayers;
  document.getElementById('coachTotalMatches').textContent = stats.totalMatches;
  document.getElementById('coachTotalGoals').textContent = stats.totalGoals;
  document.getElementById('coachTotalAssists').textContent = stats.totalAssists;
}

// ==========================================
// OYUNCU VIEW
// ==========================================

/**
 * Oyuncu panelini y√ºkle
 */
function loadPlayerView() {
  console.log('üë§ Oyuncu paneli y√ºkleniyor...');
  
  if (!currentUser.playerId) {
    document.getElementById('playerContent').innerHTML = '<p class="error-message">Oyuncu bilgisi bulunamadƒ±</p>';
    return;
  }
  
  const player = getPlayerById(currentUser.playerId);
  if (!player) {
    document.getElementById('playerContent').innerHTML = '<p class="error-message">Oyuncu bulunamadƒ±</p>';
    return;
  }
  
  // Sezon butonlarƒ±nƒ± render et
  renderSeasonButtons('playerSeasonContainer');
  
  // Oyuncu detaylarƒ±nƒ± g√∂ster
  showPlayerDetails(player);
}

/**
 * Oyuncu detaylarƒ±nƒ± g√∂ster (oyuncu kendi perspektifinden)
 */
function showPlayerDetails(player) {
  const stats = getPlayerSeasonStats(player.id, currentSeason);
  const isGK = isGoalkeeper(player.position);
  const positionName = getPositionName(player.position);
  
  let html = '';
  
  // Profil header
  html += '<div style="display: flex; gap: 30px; margin-bottom: 30px; align-items: center;">';
  html += '<div style="width: 150px; height: 150px; border-radius: 50%; overflow: hidden; border: 5px solid var(--beylerbeyi-red);">';
  if (player.photo) {
    html += '<img src="' + player.photo + '" style="width: 100%; height: 100%; object-fit: cover;">';
  } else {
    const initials = player.name.split(' ').map(n => n[0]).join('');
    html += '<div class="player-photo-placeholder" style="width: 100%; height: 100%; font-size: 48px;">' + initials + '</div>';
  }
  html += '</div>';
  html += '<div>';
  html += '<h2 style="color: var(--beylerbeyi-red); margin-bottom: 10px;">' + player.name + '</h2>';
  html += '<p style="font-size: 18px; color: #666; margin-bottom: 5px;">' + positionName + ' ‚Ä¢ ' + player.ageGroup + '</p>';
  html += '<p style="font-size: 14px; color: #999;">Ya≈ü: ' + calculateAge(player.birthYear) + ' ‚Ä¢ Boy: ' + player.height + 'cm ‚Ä¢ Kilo: ' + player.weight + 'kg</p>';
  html += '</div>';
  html += '</div>';
  
  // ƒ∞statistik kartlarƒ±
  html += '<div class="stats-grid">';
  html += '<div class="stat-card"><h3>' + stats.matches + '</h3><p>Ma√ß</p></div>';
  html += '<div class="stat-card green"><h3>' + formatMinutes(stats.minutes) + '</h3><p>S√ºre</p></div>';
  
  if (isGK) {
    html += '<div class="stat-card gold"><h3>' + (stats.cleanSheets || 0) + '</h3><p>Kale Koruma</p></div>';
    html += '<div class="stat-card dark"><h3>' + (stats.goalsConceded || 0) + '</h3><p>Yediƒüi Gol</p></div>';
  } else {
    html += '<div class="stat-card gold"><h3>' + stats.goals + '</h3><p>Gol</p></div>';
    html += '<div class="stat-card dark"><h3>' + stats.assists + '</h3><p>Asist</p></div>';
  }
  html += '</div>';
  
  // Deƒüerlendirmeler
  html += '<h3 style="margin-top: 30px; margin-bottom: 15px;">Deƒüerlendirmelerim</h3>';
  html += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">';
  
  // Fiziksel
  html += '<div class="eval-section">';
  html += '<h4>üí™ Fiziksel</h4>';
  html += createSkillBar('Sprint', player.physical.sprintSpeed);
  html += createSkillBar('Dayanƒ±klƒ±lƒ±k', player.physical.endurance);
  html += createSkillBar('√áeviklik', player.physical.agility);
  html += '</div>';
  
  // Taktik
  html += '<div class="eval-section">';
  html += '<h4>üß† Taktik</h4>';
  html += createSkillBar('Oyun Anlayƒ±≈üƒ±', player.tactical.gameUnderstanding);
  html += createSkillBar('Pozisyon Bilgisi', player.tactical.positionKnowledge);
  html += createSkillBar('Karar Verme', player.tactical.decisionMaking);
  html += '</div>';
  
  // Mental
  html += '<div class="eval-section">';
  html += '<h4>üéØ Mental</h4>';
  html += createSkillBar('Disiplin', player.mental.discipline);
  html += createSkillBar('√áalƒ±≈ükanlƒ±k', player.mental.workRate);
  html += createSkillBar('√ñzg√ºven', player.mental.confidence);
  html += '</div>';
  
  html += '</div>';
  
  // Sezon ge√ßmi≈üi
  html += '<h3 style="margin-top: 30px; margin-bottom: 15px;">Sezon Ge√ßmi≈üim</h3>';
  html += '<table>';
  html += '<thead><tr><th>Sezon</th><th>Ma√ß</th><th>Dakika</th>';
  html += isGK ? '<th>Yediƒüi Gol</th><th>Kale Koruma</th>' : '<th>Gol</th><th>Asist</th>';
  html += '<th>üü®</th><th>üü•</th></tr></thead>';
  html += '<tbody>';
  
  for (let i = 0; i < SEASONS.length; i++) {
    const season = SEASONS[i];
    const seasonStats = player.seasonStats[season.id];
    if (seasonStats && seasonStats.matches > 0) {
      html += '<tr>';
      html += '<td><strong>' + season.name + '</strong></td>';
      html += '<td>' + seasonStats.matches + '</td>';
      html += '<td>' + seasonStats.minutes + '</td>';
      
      if (isGK) {
        html += '<td>' + (seasonStats.goalsConceded || 0) + '</td>';
        html += '<td>' + (seasonStats.cleanSheets || 0) + '</td>';
      } else {
        html += '<td>' + seasonStats.goals + '</td>';
        html += '<td>' + seasonStats.assists + '</td>';
      }
      
      html += '<td>' + seasonStats.yellowCards + '</td>';
      html += '<td>' + seasonStats.redCards + '</td>';
      html += '</tr>';
    }
  }
  
  html += '</tbody></table>';
  
  document.getElementById('playerContent').innerHTML = html;
}

// ==========================================
// Y√ñNETƒ∞Cƒ∞ VIEW
// ==========================================

/**
 * Y√∂netici panelini y√ºkle
 */
function loadManagerView() {
  console.log('üìä Y√∂netici paneli y√ºkleniyor...');
  
  // Sezon butonlarƒ±nƒ± render et
  renderSeasonButtons('managerSeasonContainer');
  
  // Genel istatistikleri g√∂ster
  showManagerStats();
  
  // Raporlarƒ± g√∂ster
  showManagerReports();
}

/**
 * Y√∂netici istatistiklerini g√∂ster
 */
function showManagerStats() {
  const stats = {
    totalPlayers: players.length,
    totalGoals: 0,
    totalAssists: 0,
    totalMatches: 0
  };
  
  players.forEach(player => {
    const seasonStats = getPlayerSeasonStats(player.id, currentSeason);
    if (seasonStats) {
      stats.totalGoals += seasonStats.goals || 0;
      stats.totalAssists += seasonStats.assists || 0;
      stats.totalMatches += seasonStats.matches || 0;
    }
  });
  
  // En golc√º oyuncu
  const topScorer = getTopPerformers(currentSeason, 1)[0];
  const topScorerName = topScorer ? topScorer.player.name.split(' ')[0] : '-';
  
  // Kartlarƒ± g√ºncelle
  document.getElementById('mgrTotalPlayers').textContent = stats.totalPlayers;
  document.getElementById('mgrTeamGoals').textContent = stats.totalGoals;
  document.getElementById('mgrTeamAssists').textContent = stats.totalAssists;
  document.getElementById('mgrTopScorer').textContent = topScorerName;
}

/**
 * Y√∂netici raporlarƒ±nƒ± g√∂ster
 */
function showManagerReports() {
  // Pozisyon daƒüƒ±lƒ±mƒ±
  showPositionDistribution();
  
  // En iyi performanslar
  showTopPerformances();
  
  // Disiplin raporu
  showDisciplineReport();
  
  // Ya≈ü grubu daƒüƒ±lƒ±mƒ±
  showAgeGroupDistribution();
}

/**
 * Pozisyon daƒüƒ±lƒ±mƒ±nƒ± g√∂ster
 */
function showPositionDistribution() {
  const container = document.getElementById('positionDistribution');
  if (!container) return;
  
  const positionCounts = {};
  
  players.forEach(player => {
    const posName = getPositionName(player.position);
    positionCounts[posName] = (positionCounts[posName] || 0) + 1;
  });
  
  let html = '';
  const total = players.length;
  
  for (const [position, count] of Object.entries(positionCounts)) {
    const percentage = (count / total * 100).toFixed(1);
    html += '<div style="margin-bottom: 15px;">';
    html += '<div style="display: flex; justify-content: space-between; margin-bottom: 5px;">';
    html += '<strong>' + position + '</strong>';
    html += '<span>' + count + ' oyuncu (' + percentage + '%)</span>';
    html += '</div>';
    html += '<div style="background: #e0e0e0; height: 10px; border-radius: 5px; overflow: hidden;">';
    html += '<div style="width: ' + percentage + '%; height: 100%; background: var(--beylerbeyi-red);"></div>';
    html += '</div>';
    html += '</div>';
  }
  
  container.innerHTML = html;
}

/**
 * En iyi performanslarƒ± g√∂ster
 */
function showTopPerformances() {
  const container = document.getElementById('topPerformers');
  if (!container) return;
  
  const topPerformers = getTopPerformers(currentSeason, 10);
  
  let html = '<table>';
  html += '<thead><tr><th>Oyuncu</th><th>Pozisyon</th><th>Gol</th><th>Asist</th><th>Toplam</th></tr></thead>';
  html += '<tbody>';
  
  topPerformers.forEach(performer => {
    const player = performer.player;
    const stats = performer.stats;
    const posName = getPositionName(player.position);
    
    html += '<tr>';
    html += '<td><strong>' + player.name + '</strong></td>';
    html += '<td>' + posName + '</td>';
    html += '<td>' + stats.goals + '</td>';
    html += '<td>' + stats.assists + '</td>';
    html += '<td><strong>' + performer.totalContribution + '</strong></td>';
    html += '</tr>';
  });
  
  html += '</tbody></table>';
  container.innerHTML = html;
}

/**
 * Disiplin raporunu g√∂ster
 */
function showDisciplineReport() {
  const container = document.getElementById('disciplineReport');
  if (!container) return;
  
  const disciplineData = [];
  
  players.forEach(player => {
    const stats = getPlayerSeasonStats(player.id, currentSeason);
    if (stats && (stats.yellowCards > 0 || stats.redCards > 0)) {
      disciplineData.push({
        name: player.name,
        yellow: stats.yellowCards,
        red: stats.redCards,
        total: stats.yellowCards + (stats.redCards * 3)
      });
    }
  });
  
  disciplineData.sort((a, b) => b.total - a.total);
  
  if (disciplineData.length === 0) {
    container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Hen√ºz kart cezasƒ± yok</p>';
    return;
  }
  
  let html = '<table>';
  html += '<thead><tr><th>Oyuncu</th><th>üü® Sarƒ±</th><th>üü• Kƒ±rmƒ±zƒ±</th></tr></thead>';
  html += '<tbody>';
  
  disciplineData.forEach(item => {
    html += '<tr>';
    html += '<td><strong>' + item.name + '</strong></td>';
    html += '<td>' + item.yellow + '</td>';
    html += '<td>' + item.red + '</td>';
    html += '</tr>';
  });
  
  html += '</tbody></table>';
  container.innerHTML = html;
}

/**
 * Ya≈ü grubu daƒüƒ±lƒ±mƒ±nƒ± g√∂ster
 */
function showAgeGroupDistribution() {
  const container = document.getElementById('ageGroupDistribution');
  if (!container) return;
  
  const ageGroupCounts = {};
  
  AGE_GROUPS.forEach(ag => {
    ageGroupCounts[ag.id] = 0;
  });
  
  players.forEach(player => {
    ageGroupCounts[player.ageGroup] = (ageGroupCounts[player.ageGroup] || 0) + 1;
  });
  
  let html = '';
  const total = players.length;
  
  for (const [ageGroup, count] of Object.entries(ageGroupCounts)) {
    const percentage = total > 0 ? (count / total * 100).toFixed(1) : 0;
    html += '<div style="margin-bottom: 15px;">';
    html += '<div style="display: flex; justify-content: space-between; margin-bottom: 5px;">';
    html += '<strong>' + ageGroup + '</strong>';
    html += '<span>' + count + ' oyuncu (' + percentage + '%)</span>';
    html += '</div>';
    html += '<div style="background: #e0e0e0; height: 10px; border-radius: 5px; overflow: hidden;">';
    html += '<div style="width: ' + percentage + '%; height: 100%; background: var(--beylerbeyi-green);"></div>';
    html += '</div>';
    html += '</div>';
  }
  
  container.innerHTML = html;
}

// ==========================================
// ADMƒ∞N VIEW
// ==========================================

/**
 * Admin panelini y√ºkle
 */
function loadAdminView() {
  console.log('‚öôÔ∏è Admin paneli y√ºkleniyor...');
  
  // Sezon butonlarƒ±nƒ± render et
  renderSeasonButtons('adminSeasonContainer');
  
  // T√ºm oyuncularƒ± listele
  renderAdminPlayersList();
  
  // ƒ∞statistikleri g√∂ster
  showAdminStats();
}

/**
 * Admin oyuncu listesini render et
 */
function renderAdminPlayersList() {
  const container = document.getElementById('adminPlayersList');
  if (!container) return;
  
  let html = '';
  
  players.forEach(player => {
    const posName = getPositionName(player.position);
    html += '<tr>';
    html += '<td>';
    if (player.photo) {
      html += '<img src="' + player.photo + '" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">';
    } else {
      const initials = player.name.split(' ').map(n => n[0]).join('');
      html += '<div style="width: 40px; height: 40px; border-radius: 50%; background: var(--beylerbeyi-red); color: white; display: flex; align-items: center; justify-content: center; font-weight: bold;">' + initials + '</div>';
    }
    html += '</td>';
    html += '<td><strong>' + player.name + '</strong></td>';
    html += '<td>' + player.ageGroup + '</td>';
    html += '<td>' + posName + '</td>';
    html += '<td>';
    html += '<button class="action-btn" onclick="editPlayer(' + player.id + ')">D√ºzenle</button>';
    html += '<button class="action-btn btn-danger" onclick="confirmDeletePlayer(' + player.id + ')">Sil</button>';
    html += '</td>';
    html += '</tr>';
  });
  
  container.innerHTML = html;
}

/**
 * Admin istatistiklerini g√∂ster
 */
function showAdminStats() {
  // √ñzet kartlar
  document.getElementById('adminTotalPlayers').textContent = players.length;
  document.getElementById('adminTotalTeams').textContent = teams.length;
  document.getElementById('adminTotalCoaches').textContent = Object.values(USERS).filter(u => u.role === 'coach').length;
  document.getElementById('adminActiveSeasons').textContent = SEASONS.filter(s => s.active).length;
}

// ==========================================
// YARDIMCI FONKSƒ∞YONLAR
// ==========================================

/**
 * Skill bar olu≈ütur
 */
function createSkillBar(label, value) {
  const percentage = (value / 10) * 100;
  let color = '#dc3545';
  if (value >= 8) color = '#28a745';
  else if (value >= 6) color = '#ffc107';
  
  let html = '<div style="margin-bottom: 12px;">';
  html += '<div style="display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 13px;">';
  html += '<span><strong>' + label + '</strong></span>';
  html += '<span>' + value.toFixed(1) + '/10</span>';
  html += '</div>';
  html += '<div style="background: #e0e0e0; height: 8px; border-radius: 10px; overflow: hidden;">';
  html += '<div style="width: ' + percentage + '%; height: 100%; background: ' + color + '; transition: width 0.3s;"></div>';
  html += '</div>';
  html += '</div>';
  
  return html;
}

/**
 * Eval section olu≈ütur
 */
function createEvalSection(title, icon, skills) {
  let html = '<div class="eval-section">';
  html += '<h4>' + icon + ' ' + title + '</h4>';
  html += '<div class="skill-bars">';
  
  for (const [label, value] of Object.entries(skills)) {
    if (typeof value === 'number') {
      html += createSkillBar(label, value);
    }
  }
  
  html += '</div></div>';
  return html;
}


// ===== MODALS.JS =====
// ==========================================
// MODAL FUNCTIONS
// ==========================================

// ==========================================
// OYUNCU DETAY MODAL
// ==========================================

/**
 * Oyuncu detay modalƒ±nƒ± a√ß
 */
function openPlayerModal(playerId) {
  const player = getPlayerById(playerId);
  if (!player) {
    alert('Oyuncu bulunamadƒ±');
    return;
  }
  
  const modal = document.getElementById('playerModal');
  const content = document.getElementById('playerModalContent');
  
  const stats = getPlayerSeasonStats(playerId, currentSeason);
  const isGK = isGoalkeeper(player.position);
  const positionName = getPositionName(player.position);
  
  let html = '';
  
  // Header
  html += '<div style="display: flex; gap: 30px; margin-bottom: 30px; align-items: center;">';
  html += '<div style="width: 150px; height: 150px; border-radius: 50%; overflow: hidden; border: 5px solid var(--beylerbeyi-red);">';
  if (player.photo) {
    html += '<img src="' + player.photo + '" style="width: 100%; height: 100%; object-fit: cover;">';
  } else {
    const initials = player.name.split(' ').map(n => n[0]).join('');
    html += '<div class="player-photo-placeholder" style="width: 100%; height: 100%; font-size: 48px;">' + initials + '</div>';
  }
  html += '</div>';
  html += '<div>';
  html += '<h2 style="color: var(--beylerbeyi-red); margin-bottom: 10px;">' + player.name + '</h2>';
  html += '<p style="font-size: 18px; color: #666;">' + positionName + ' ‚Ä¢ ' + player.ageGroup + '</p>';
  html += '<p style="font-size: 14px; color: #999; margin-top: 5px;">Ya≈ü: ' + calculateAge(player.birthYear) + ' ‚Ä¢ Boy: ' + player.height + 'cm ‚Ä¢ Kilo: ' + player.weight + 'kg</p>';
  html += '</div>';
  html += '</div>';
  
  // Sezon Se√ßici
  html += '<div class="season-selector" style="margin-bottom: 20px;">';
  for (let i = 0; i < SEASONS.length; i++) {
    const season = SEASONS[i];
    const isActive = season.id === currentSeason;
    html += '<button class="season-btn' + (isActive ? ' active' : '') + '" onclick="changeModalSeason(\'' + season.id + '\')">' + season.name + '</button>';
  }
  html += '</div>';
  
  // ƒ∞statistikler
  html += '<h3>üìä ' + currentSeason + ' Sezonu ƒ∞statistikleri</h3>';
  html += '<div class="stats-grid" style="margin-top: 15px;">';
  html += '<div class="stat-card"><h3>' + stats.matches + '</h3><p>Ma√ß</p></div>';
  html += '<div class="stat-card green"><h3>' + stats.minutes + '</h3><p>Dakika</p></div>';
  
  if (isGK) {
    html += '<div class="stat-card gold"><h3>' + (stats.cleanSheets || 0) + '</h3><p>Kale Koruma</p></div>';
    html += '<div class="stat-card dark"><h3>' + (stats.goalsConceded || 0) + '</h3><p>Yediƒüi Gol</p></div>';
  } else {
    html += '<div class="stat-card gold"><h3>' + stats.goals + '</h3><p>Gol</p></div>';
    html += '<div class="stat-card dark"><h3>' + stats.assists + '</h3><p>Asist</p></div>';
  }
  html += '</div>';
  
  // Deƒüerlendirmeler
  html += '<h3 style="margin-top: 30px; margin-bottom: 15px;">Deƒüerlendirmeler</h3>';
  html += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">';
  
  // Fiziksel
  html += '<div class="eval-section">';
  html += '<h4>üí™ Fiziksel</h4>';
  html += createSkillBar('Sprint Hƒ±zƒ±', player.physical.sprintSpeed);
  html += createSkillBar('Dayanƒ±klƒ±lƒ±k', player.physical.endurance);
  html += createSkillBar('√áeviklik', player.physical.agility);
  html += createSkillBar('Denge', player.physical.balance);
  html += createSkillBar('Kuvvet', player.physical.strength);
  html += '</div>';
  
  // Taktik
  html += '<div class="eval-section">';
  html += '<h4>üß† Taktik</h4>';
  html += createSkillBar('Oyun Anlayƒ±≈üƒ±', player.tactical.gameUnderstanding);
  html += createSkillBar('Pozisyon Bilgisi', player.tactical.positionKnowledge);
  html += createSkillBar('Karar Verme', player.tactical.decisionMaking);
  html += createSkillBar('Ge√ßi≈üler', player.tactical.transitions);
  html += createSkillBar('Alan & Zamanlama', player.tactical.spacingTiming);
  html += '</div>';
  
  // Mental
  html += '<div class="eval-section">';
  html += '<h4>üéØ Mental</h4>';
  html += createSkillBar('Disiplin', player.mental.discipline);
  html += createSkillBar('√áalƒ±≈ükanlƒ±k', player.mental.workRate);
  html += createSkillBar('√ñƒürenme ƒ∞steƒüi', player.mental.learningAttitude);
  html += createSkillBar('√ñzg√ºven', player.mental.confidence);
  html += createSkillBar('Rekabet', player.mental.competitiveness);
  html += createSkillBar('Takƒ±m Uyumu', player.mental.teamHarmony);
  html += createSkillBar('Baskƒ± Altƒ±nda', player.mental.pressurePerformance);
  html += '</div>';
  
  html += '</div>';
  
  content.innerHTML = html;
  modal.style.display = 'block';
}

/**
 * Oyuncu modalƒ±nƒ± kapat
 */
function closePlayerModal() {
  document.getElementById('playerModal').style.display = 'none';
}

/**
 * Modal i√ßinde sezon deƒüi≈ütir
 */
function changeModalSeason(seasonId) {
  currentSeason = seasonId;
  
  // Modal'ƒ± yeniden a√ß
  const modal = document.getElementById('playerModal');
  if (modal.style.display === 'block') {
    const content = document.getElementById('playerModalContent');
    const playerName = content.querySelector('h2').textContent;
    const player = players.find(p => p.name === playerName);
    if (player) {
      openPlayerModal(player.id);
    }
  }
}

// ==========================================
// OYUNCU EKLE/D√úZENLE MODAL
// ==========================================

let editingPlayerId = null;

/**
 * Oyuncu ekleme modalƒ±nƒ± g√∂ster
 */
function showAddPlayerModal() {
  editingPlayerId = null;
  
  document.getElementById('playerFormTitle').textContent = 'Yeni Oyuncu Ekle';
  document.getElementById('playerFormId').value = '';
  
  // Formu temizle
  document.getElementById('playerName').value = '';
  document.getElementById('playerBirthYear').value = '';
  document.getElementById('playerHeight').value = '';
  document.getElementById('playerWeight').value = '';
  document.getElementById('playerPreviousClub').value = '';
  
  // Select'leri doldur
  populateAgeGroupSelect();
  populatePositionSelect();
  
  document.getElementById('addPlayerModal').style.display = 'block';
}

/**
 * Oyuncu d√ºzenleme modalƒ±nƒ± g√∂ster
 */
function editPlayer(playerId) {
  const player = getPlayerById(playerId);
  if (!player) {
    alert('Oyuncu bulunamadƒ±');
    return;
  }
  
  editingPlayerId = playerId;
  
  document.getElementById('playerFormTitle').textContent = 'Oyuncu D√ºzenle';
  document.getElementById('playerFormId').value = playerId;
  
  // Formu doldur
  document.getElementById('playerName').value = player.name;
  document.getElementById('playerBirthYear').value = player.birthYear;
  document.getElementById('playerHeight').value = player.height;
  document.getElementById('playerWeight').value = player.weight;
  document.getElementById('playerPreviousClub').value = player.previousClub;
  
  // Select'leri doldur
  populateAgeGroupSelect();
  populatePositionSelect();
  
  document.getElementById('playerAgeGroup').value = player.ageGroup;
  document.getElementById('playerPosition').value = player.position;
  document.getElementById('playerFoot').value = player.foot;
  
  document.getElementById('addPlayerModal').style.display = 'block';
}

/**
 * Oyuncu ekleme/d√ºzenleme modalƒ±nƒ± kapat
 */
function closeAddPlayerModal() {
  document.getElementById('addPlayerModal').style.display = 'none';
  editingPlayerId = null;
}

/**
 * Ya≈ü grubu select'ini doldur
 */
function populateAgeGroupSelect() {
  const select = document.getElementById('playerAgeGroup');
  select.innerHTML = '';
  
  AGE_GROUPS.forEach(ag => {
    const option = document.createElement('option');
    option.value = ag.id;
    option.textContent = ag.displayName;
    select.appendChild(option);
  });
}

/**
 * Pozisyon select'ini doldur
 */
function populatePositionSelect() {
  const select = document.getElementById('playerPosition');
  select.innerHTML = '';
  
  // Kategorilere g√∂re grupla
  const categories = {};
  POSITIONS.forEach(pos => {
    if (!categories[pos.category]) {
      categories[pos.category] = [];
    }
    categories[pos.category].push(pos);
  });
  
  // Her kategori i√ßin optgroup olu≈ütur
  for (const [category, positions] of Object.entries(categories)) {
    const optgroup = document.createElement('optgroup');
    optgroup.label = category;
    
    positions.forEach(pos => {
      const option = document.createElement('option');
      option.value = pos.id;
      option.textContent = pos.name;
      optgroup.appendChild(option);
    });
    
    select.appendChild(optgroup);
  }
}

/**
 * Oyuncu kaydet (ekle veya d√ºzenle)
 */
function savePlayer(event) {
  event.preventDefault();
  
  const playerData = {
    name: document.getElementById('playerName').value.trim(),
    birthYear: parseInt(document.getElementById('playerBirthYear').value),
    ageGroup: document.getElementById('playerAgeGroup').value,
    position: document.getElementById('playerPosition').value,
    height: parseInt(document.getElementById('playerHeight').value) || 170,
    weight: parseInt(document.getElementById('playerWeight').value) || 65,
    foot: document.getElementById('playerFoot').value,
    previousClub: document.getElementById('playerPreviousClub').value.trim() || 'Beylerbeyi 1911',
    photo: null,
    joinDate: new Date().toISOString().split('T')[0]
  };
  
  // Validasyon
  const validation = validatePlayerData(playerData);
  if (!validation.isValid) {
    alert('Hata:\n' + validation.errors.join('\n'));
    return;
  }
  
  if (editingPlayerId) {
    // G√ºncelle
    updatePlayer(editingPlayerId, playerData);
    showSuccess('Oyuncu ba≈üarƒ±yla g√ºncellendi');
  } else {
    // Yeni ekle
    addPlayer(playerData);
    showSuccess('Oyuncu ba≈üarƒ±yla eklendi');
  }
  
  // LocalStorage'a kaydet
  saveToLocalStorage();
  
  // Modal'ƒ± kapat
  closeAddPlayerModal();
  
  // Listeyi yenile
  if (currentUser.role === 'admin') {
    renderAdminPlayersList();
  } else if (currentUser.role === 'coach') {
    renderPlayersGrid();
  }
}

/**
 * Oyuncu silme onayƒ±
 */
function confirmDeletePlayer(playerId) {
  const player = getPlayerById(playerId);
  if (!player) {
    alert('Oyuncu bulunamadƒ±');
    return;
  }
  
  if (!canDeletePlayer(currentUser, playerId)) {
    alert('Bu oyuncuyu silme yetkiniz yok');
    return;
  }
  
  if (confirm('Oyuncuyu silmek istediƒüinize emin misiniz?\n\nOyuncu: ' + player.name)) {
    deletePlayer(playerId);
    saveToLocalStorage();
    showSuccess('Oyuncu ba≈üarƒ±yla silindi');
    
    // Listeyi yenile
    if (currentUser.role === 'admin') {
      renderAdminPlayersList();
      showAdminStats();
    }
  }
}

// ==========================================
// MODAL DI≈ûINA TIKLAMA
// ==========================================

window.onclick = function(event) {
  const playerModal = document.getElementById('playerModal');
  const addPlayerModal = document.getElementById('addPlayerModal');
  
  if (event.target === playerModal) {
    closePlayerModal();
  }
  
  if (event.target === addPlayerModal) {
    closeAddPlayerModal();
  }
};


</script>
</body>
</html>
